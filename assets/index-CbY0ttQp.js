import{g as e,h as a,o as i,i as l,j as n,k as t,w as s,F as r,l as d,u,r as o,I as v,t as g,n as m,p as y,q as c}from"./vendor-BQMuZSJ1.js";import{_ as p}from"./index-BKcSugxN.js";const x=e=>(y("data-v-7bc21725"),e=e(),c(),e),k={class:"page"},f={class:"upload-box"},w={class:"upload"},h={class:"ant-upload-drag-icon"},b=x((()=>n("p",{class:"ant-upload-text"},"点击或拖动文件到该区域上传",-1))),D=x((()=>n("p",{class:"ant-upload-hint"}," 支持单次或批量上传 ",-1))),_={class:"select-box"},I={style:{"text-align":"left"}},O={class:"custom-item",style:{color:"red"}},T={class:"show-box"},j=["draggable","onDragstart","onDrop"],L=["src"],F=["src"],R=p(e({__name:"index",setup(e){const y=a([]),c=e=>{const a=y.value.indexOf(e),i=y.value.slice();i.splice(a,1),y.value=i},p=async e=>(e.url||e.preview||(e.preview=await J(e)),e.key=e.uid,y.value=[...y.value||[],e],!1),x=a(!1),R=a(""),U=a(""),A=async e=>{e.url||e.preview||(e.preview=await J(e.originFileObj)),R.value=e.url||e.preview,x.value=!0,U.value=e.name||e.url.substring(e.url.lastIndexOf("/")+1)},C=()=>{x.value=!1,U.value=""};function J(e){return new Promise(((a,i)=>{const l=new FileReader;l.readAsDataURL(e),l.onload=()=>a(l.result),l.onerror=e=>i(e)}))}const N=a(),P=(e,a,i)=>{var l;const n=null==(l=y.value)?void 0:l.filter((a=>e.includes(a.key)));let t=S.value.filter((e=>e.image));if(t.length>0){let e=n.map((e=>e.key));if(S.value=S.value.map((a=>a.key&&!e.includes(a.key)?{...a,image:"",key:""}:(e.includes(a.key)&&(e=e.filter((e=>e!==a.key))),a))),e.length)for(let a=0;a<e.length;a++){const i=S.value.findIndex((e=>""===e.key)),l=n.find((i=>i.key==e[a]));S.value[i].image=l.preview,S.value[i].key=l.key}}else for(let s=0;s<n.length;s++)S.value[s].image=n[s].preview,S.value[s].key=n[s].key;t=S.value.filter((e=>e.image))};let S=a([{index:1,image:"",key:""},{index:2,image:"",key:""},{index:3,image:"",key:""},{index:4,image:"",key:""},{index:5,image:"",key:""},{index:6,image:"",key:""},{index:7,image:"",key:""},{index:8,image:"",key:""},{index:9,image:"",key:""},{index:10,image:"",key:""},{index:11,image:"",key:""},{index:12,image:"",key:""},{index:13,image:"",key:""},{index:14,image:"",key:""},{index:15,image:"",key:""},{index:16,image:"",key:""},{index:17,image:"",key:""},{index:18,image:"",key:""},{index:19,image:"",key:""},{index:20,image:"",key:""}]),q=a(null);function E(){q.value=null}return(e,a)=>{const J=o("a-upload-dragger"),K=o("a-image"),z=o("a-transfer"),B=o("a-modal");return i(),l("div",k,[n("div",f,[n("div",w,[t(J,{fileList:y.value,"onUpdate:fileList":a[0]||(a[0]=e=>y.value=e),name:"file",multiple:!0,listType:"picture-card","before-upload":p,onRemove:c,onPreview:A},{default:s((()=>[n("p",h,[t(u(v))]),b,D])),_:1},8,["fileList"])])]),n("div",_,[t(z,{"target-keys":N.value,"onUpdate:targetKeys":a[1]||(a[1]=e=>N.value=e),titles:["上传","展示"],"data-source":y.value,"list-style":{width:"300px",height:"300px"},onChange:P},{render:s((e=>[n("div",I,[t(K,{width:40,height:40,src:e.preview},null,8,["src"]),n("span",O,g(e.name),1)])])),_:1},8,["target-keys","data-source"])]),n("div",T,[(i(!0),l(r,null,d(u(S),(e=>(i(),l("div",{key:e.index,class:"box"},[n("div",{class:"item",draggable:!!e.image,onDragstart:a=>function(e,a){q.value=e,a.dataTransfer.effectAllowed="move",a.dataTransfer.setData("text/plain",JSON.stringify(e))}(e,a),onDragover:a[2]||(a[2]=e=>{return(a=e).preventDefault(),void(a.dataTransfer.dropEffect="move");var a}),onDrop:a=>function(e,a){a.preventDefault();const i=JSON.parse(a.dataTransfer.getData("text/plain")),l=S.value.findIndex((a=>a.index===e.index)),n=S.value.findIndex((e=>e.index===i.index));if(l>-1&&n>-1){const e={...S.value[l]};S.value[l].image=S.value[n].image,S.value[l].key=S.value[n].key,S.value[n].image=e.image,S.value[n].key=e.key}}(e,a),onDragend:E},[e.image?(i(),l("img",{key:0,style:{width:"100px",height:"100px"},src:e.image},null,8,L)):(i(),l(r,{key:1},[m(g(e.index),1)],64))],40,j)])))),128))]),t(B,{open:x.value,title:U.value,footer:null,onCancel:C},{default:s((()=>[n("img",{alt:"example",style:{width:"100%"},src:R.value},null,8,F)])),_:1},8,["open","title"])])}}}),[["__scopeId","data-v-7bc21725"]]);export{R as default};
//# sourceMappingURL=index-CbY0ttQp.js.map
